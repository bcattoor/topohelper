<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
  <Product Id="1eb1d6f2-8704-4d6f-9bde-83d08318e141" Name="Infrabel IAM:Topo Helper, AutoCAD-plugin." Language="1033" Codepage="Windows-1252" Version="1.1.1.0" UpgradeCode="1eb1d6f2-8704-4d6f-9bde-83d07308d140" Manufacturer="By Bjorn Cattoor, for Infrabel.">
    <Package InstallerVersion="200" Compressed="yes" Description="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" SummaryCodepage="Windows-1252" InstallPrivileges="limited" InstallScope="perUser" Languages="1033" />
    <Media Id="1" Cabinet="Topo_Helper__AutoCAD_plugin._.cab" EmbedCab="yes" />

    <Condition Message="Please install .NET 4.6 first. Contact your system administrator to install."><![CDATA[ (NETFRAMEWORK45 >= "#393295") ]]></Condition>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="LocalAppDataFolder" Name="LocalAppDataFolder">
        <Directory Id="LocalAppDataFolder.Infrabel" Name="Infrabel">

          <Component Id="Component.LocalAppDataFolder.Infrabel" Guid="1eb1d6f2-8704-4d6f-9bde-83d080493a18">
            <CreateFolder />
            <RemoveFolder Id="LocalAppDataFolder.Infrabel" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Directory Id="INSTALLDIR" Name="TopoHelper">

            <Component Id="Component.INSTALLDIR" Guid="1eb1d6f2-8704-4d6f-9bde-83d0a6334d63">
              <CreateFolder />
              <RemoveFolder Id="INSTALLDIR" On="uninstall" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.readme.txt_3785463527" Guid="1eb1d6f2-8704-4d6f-9bde-83d04e62c61b">
              <File Id="readme.txt_3785463527" Source="readme.txt" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.license.rtf_3413147871" Guid="1eb1d6f2-8704-4d6f-9bde-83d095f90ade">
              <File Id="license.rtf_3413147871" Source="license.rtf" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.ATL" Guid="1eb1d6f2-8704-4d6f-9bde-83d043478eac">
              <File Id="ATL" Source="trustedlocations\AutocadTrustedLocations.exe" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.CommandLineArgumentsParser.dll_3014265501" Guid="1eb1d6f2-8704-4d6f-9bde-83d09ca4db3a">
              <File Id="CommandLineArgumentsParser.dll_3014265501" Source="trustedlocations\CommandLineArgumentsParser.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.AutocadTrustedLocations.exe.config_3323726735" Guid="1eb1d6f2-8704-4d6f-9bde-83d0c21684af">
              <File Id="AutocadTrustedLocations.exe.config_3323726735" Source="trustedlocations\AutocadTrustedLocations.exe.config" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.AdUIMgd.dll_1500037100" Guid="1eb1d6f2-8704-4d6f-9bde-83d0a70f314d">
              <File Id="AdUIMgd.dll_1500037100" Source="release\AdUIMgd.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.CsvHelper.dll_2903748690" Guid="1eb1d6f2-8704-4d6f-9bde-83d0f10d9b0f">
              <File Id="CsvHelper.dll_2903748690" Source="release\CsvHelper.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.CsvHelper.xml_174603191" Guid="1eb1d6f2-8704-4d6f-9bde-83d0347a2e95">
              <File Id="CsvHelper.xml_174603191" Source="release\CsvHelper.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.MoreLinq.dll_344342342" Guid="1eb1d6f2-8704-4d6f-9bde-83d067a37ab1">
              <File Id="MoreLinq.dll_344342342" Source="release\MoreLinq.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.MoreLinq.pdb_1151435664" Guid="1eb1d6f2-8704-4d6f-9bde-83d037384ac2">
              <File Id="MoreLinq.pdb_1151435664" Source="release\MoreLinq.pdb" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.MoreLinq.xml_344407850" Guid="1eb1d6f2-8704-4d6f-9bde-83d0feec1b5d">
              <File Id="MoreLinq.xml_344407850" Source="release\MoreLinq.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.Simplifynet.dll_3673655797" Guid="1eb1d6f2-8704-4d6f-9bde-83d0629bca14">
              <File Id="Simplifynet.dll_3673655797" Source="release\Simplifynet.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.Simplifynet.pdb_1379502573" Guid="1eb1d6f2-8704-4d6f-9bde-83d02f40dd26">
              <File Id="Simplifynet.pdb_1379502573" Source="release\Simplifynet.pdb" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Buffers.dll_591463195" Guid="1eb1d6f2-8704-4d6f-9bde-83d0288c8231">
              <File Id="System.Buffers.dll_591463195" Source="release\System.Buffers.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Buffers.xml_3804686079" Guid="1eb1d6f2-8704-4d6f-9bde-83d0a1c2293c">
              <File Id="System.Buffers.xml_3804686079" Source="release\System.Buffers.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Memory.dll_4007401346" Guid="1eb1d6f2-8704-4d6f-9bde-83d00e0a62fd">
              <File Id="System.Memory.dll_4007401346" Source="release\System.Memory.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Memory.xml_2441055261" Guid="1eb1d6f2-8704-4d6f-9bde-83d0f9bea1f5">
              <File Id="System.Memory.xml_2441055261" Source="release\System.Memory.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Numerics.Vectors.dll_3180875874" Guid="1eb1d6f2-8704-4d6f-9bde-83d05d6e775a">
              <File Id="System.Numerics.Vectors.dll_3180875874" Source="release\System.Numerics.Vectors.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Numerics.Vectors.xml_2416201827" Guid="1eb1d6f2-8704-4d6f-9bde-83d04d239b2e">
              <File Id="System.Numerics.Vectors.xml_2416201827" Source="release\System.Numerics.Vectors.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Runtime.CompilerServices.Unsafe.dll_2461978377" Guid="1eb1d6f2-8704-4d6f-9bde-83d0434879b5">
              <File Id="System.Runtime.CompilerServices.Unsafe.dll_2461978377" Source="release\System.Runtime.CompilerServices.Unsafe.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Runtime.CompilerServices.Unsafe.xml_1762570989" Guid="1eb1d6f2-8704-4d6f-9bde-83d06762e322">
              <File Id="System.Runtime.CompilerServices.Unsafe.xml_1762570989" Source="release\System.Runtime.CompilerServices.Unsafe.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Threading.Tasks.Extensions.dll_498185729" Guid="1eb1d6f2-8704-4d6f-9bde-83d0fad3db4b">
              <File Id="System.Threading.Tasks.Extensions.dll_498185729" Source="release\System.Threading.Tasks.Extensions.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.Threading.Tasks.Extensions.xml_2065056102" Guid="1eb1d6f2-8704-4d6f-9bde-83d0a69cf742">
              <File Id="System.Threading.Tasks.Extensions.xml_2065056102" Source="release\System.Threading.Tasks.Extensions.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.ValueTuple.dll_3570342207" Guid="1eb1d6f2-8704-4d6f-9bde-83d00e346dea">
              <File Id="System.ValueTuple.dll_3570342207" Source="release\System.ValueTuple.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.System.ValueTuple.xml_2002423258" Guid="1eb1d6f2-8704-4d6f-9bde-83d043a85306">
              <File Id="System.ValueTuple.xml_2002423258" Source="release\System.ValueTuple.xml" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.TopoHelper.dll_3807985437" Guid="1eb1d6f2-8704-4d6f-9bde-83d0bb730c38">
              <File Id="TopoHelper.dll_3807985437" Source="release\TopoHelper.dll" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.TopoHelper.dll.config_2551281173" Guid="1eb1d6f2-8704-4d6f-9bde-83d0f341f9fd">
              <File Id="TopoHelper.dll.config_2551281173" Source="release\TopoHelper.dll.config" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

            <Component Id="Component.TopoHelper.pdb_4080425795" Guid="1eb1d6f2-8704-4d6f-9bde-83d0ff8ab5d5">
              <File Id="TopoHelper.pdb_4080425795" Source="release\TopoHelper.pdb" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

          </Directory>
        </Directory>
      </Directory>

      <Directory Id="ProgramFilesFolder" Name="ProgramFilesFolder">

        <Component Id="Registry.1" Guid="1eb1d6f2-8704-4d6f-9bde-83d070259fbf" KeyPath="yes">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADCTRLS" Type="integer" KeyPath="no" Value="14" Name="LOADCTRLS" />
          </RegistryKey>

          <CreateFolder />
          <RemoveFolder Id="ProgramFilesFolder" On="uninstall" />
        </Component>

        <Component Id="Registry.2" Guid="1eb1d6f2-8704-4d6f-9bde-83d070269fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADER" Type="string" KeyPath="yes" Value="[INSTALLDIR]TopoHelper.dll" Name="LOADER" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.3" Guid="1eb1d6f2-8704-4d6f-9bde-83d070279fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="MANAGED" Type="integer" KeyPath="yes" Value="1" Name="MANAGED" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.4" Guid="1eb1d6f2-8704-4d6f-9bde-83d070209fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="DESCRIPTION" Type="string" KeyPath="yes" Value="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" Name="DESCRIPTION" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.5" Guid="1eb1d6f2-8704-4d6f-9bde-83d070219fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-3001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADCTRLS.1" Type="integer" KeyPath="yes" Value="14" Name="LOADCTRLS" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.6" Guid="1eb1d6f2-8704-4d6f-9bde-83d070229fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-3001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADER.1" Type="string" KeyPath="yes" Value="[INSTALLDIR]TopoHelper.dll" Name="LOADER" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.7" Guid="1eb1d6f2-8704-4d6f-9bde-83d070239fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-3001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="MANAGED.1" Type="integer" KeyPath="yes" Value="1" Name="MANAGED" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.8" Guid="1eb1d6f2-8704-4d6f-9bde-83d0701c9fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-3001:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="DESCRIPTION.1" Type="string" KeyPath="yes" Value="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" Name="DESCRIPTION" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.9" Guid="1eb1d6f2-8704-4d6f-9bde-83d0701d9fbf">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-4101:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADCTRLS.2" Type="integer" KeyPath="yes" Value="14" Name="LOADCTRLS" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.10" Guid="1eb1d6f2-8704-4d6f-9bde-83d02144b4b0">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-4101:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADER.2" Type="string" KeyPath="yes" Value="[INSTALLDIR]TopoHelper.dll" Name="LOADER" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.11" Guid="1eb1d6f2-8704-4d6f-9bde-83d0c3ec294b">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-4101:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="MANAGED.2" Type="integer" KeyPath="yes" Value="1" Name="MANAGED" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.12" Guid="1eb1d6f2-8704-4d6f-9bde-83d0dbf5cb7a">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-4101:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="DESCRIPTION.2" Type="string" KeyPath="yes" Value="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" Name="DESCRIPTION" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.13" Guid="1eb1d6f2-8704-4d6f-9bde-83d07e9d3f15">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2000:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADCTRLS.3" Type="integer" KeyPath="yes" Value="14" Name="LOADCTRLS" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.14" Guid="1eb1d6f2-8704-4d6f-9bde-83d096a7e244">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2000:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADER.3" Type="string" KeyPath="yes" Value="[INSTALLDIR]TopoHelper.dll" Name="LOADER" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.15" Guid="1eb1d6f2-8704-4d6f-9bde-83d0394e56df">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2000:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="MANAGED.3" Type="integer" KeyPath="yes" Value="1" Name="MANAGED" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.16" Guid="1eb1d6f2-8704-4d6f-9bde-83d05158f80e">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2000:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="DESCRIPTION.3" Type="string" KeyPath="yes" Value="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" Name="DESCRIPTION" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.17" Guid="1eb1d6f2-8704-4d6f-9bde-83d0f3ff6da9">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R24.0\ACAD-4100:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADCTRLS.4" Type="integer" KeyPath="yes" Value="14" Name="LOADCTRLS" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.18" Guid="1eb1d6f2-8704-4d6f-9bde-83d00c090fd8">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R24.0\ACAD-4100:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="LOADER.4" Type="string" KeyPath="yes" Value="[INSTALLDIR]TopoHelper.dll" Name="LOADER" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.19" Guid="1eb1d6f2-8704-4d6f-9bde-83d0aeb08473">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R24.0\ACAD-4100:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="MANAGED.4" Type="integer" KeyPath="yes" Value="1" Name="MANAGED" />
          </RegistryKey>

          <CreateFolder />
        </Component>

        <Component Id="Registry.20" Guid="1eb1d6f2-8704-4d6f-9bde-83d02145b4b0">
          <RegistryKey Root="HKMU" Key="Software\Autodesk\AutoCAD\R24.0\ACAD-4100:409\Applications\Infrabel.TopoHelper">
            <RegistryValue Id="DESCRIPTION.4" Type="string" KeyPath="yes" Value="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" Name="DESCRIPTION" />
          </RegistryKey>

          <CreateFolder />
        </Component>

      </Directory>
    </Directory>

    <PropertyRef Id="NETFRAMEWORK45" />

    <UI />

    <WixVariable Id="WixUILicenseRtf" Value="C:\Users\cwn8400\Documents\GitHub\topohelper2022\TopoHelper.WixSharpSetup\files\license.rtf" />

    <Upgrade Id="1eb1d6f2-8704-4d6f-9bde-83d07308d140">
      <UpgradeVersion Minimum="0.0.0.0" Maximum="1.1.1.0" IncludeMinimum="yes" IncludeMaximum="no" Property="UPGRADEFOUND" />
      <UpgradeVersion Minimum="1.1.1.0" IncludeMinimum="no" Property="NEWPRODUCTFOUND" />
    </Upgrade>

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="WixSharp_BeforeInstall_Action" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_BeforeInstall_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];FOUNDPREVIOUSVERSION=[FOUNDPREVIOUSVERSION];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="Set_ARPINSTALLLOCATION" Property="ARPINSTALLLOCATION" Value="%LocalAppData%\Infrabel\TopoHelper" Return="check" Execute="immediate" />
    <CustomAction Id="PreventDowngrading" Error="Newer version already installed" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="..\..\installer\WixSharp.CA.dll" />

    <UIRef Id="WixUI_Mondo" />
    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="WixSharp_BeforeInstall_Handlers" Value="WixSharp Setup, Version=1.1.1.0, Culture=neutral, PublicKeyToken=null|TopoHelper.WixSharpSetup.Program|Project_BeforeInstall" />
    <Property Id="WixSharp_AfterInstall_Handlers" Value="WixSharp Setup, Version=1.1.1.0, Culture=neutral, PublicKeyToken=null|TopoHelper.WixSharpSetup.Program|Project_AfterInstall" />
    <Property Id="ARPCOMMENTS" Value="This application is for internal Infrabel usage only. It is a proof of concept, and should only be used as such. No warrenty is given!" />
    <Property Id="ARPCONTACT" Value="Bjorn.Cattoor@Infrabel.be" />
    <Property Id="ARPHELPTELEPHONE" Value="helpdesk" />
    <Property Id="ARPREADME" Value="%LocalAppData%\Infrabel\TopoHelper\readme.txt" />

    <Feature Id="Thie_binary_s" Title="Thie binary's" Absent="disallow" Level="1" Description="The application binary's. This is mandatory of-course.">
      <ComponentRef Id="Component.LocalAppDataFolder.Infrabel" />
      <ComponentRef Id="Component.INSTALLDIR" />
    </Feature>

    <Feature Id="_...oload_into_AutoCAD_on_startup." Title="Autoload into AutoCAD on startup." Absent="allow" Level="1" Description="Check this if you want to register the dll to automatically load upon the launching of AutoCAD.">
      <ComponentRef Id="Registry.1" />
      <ComponentRef Id="Registry.2" />
      <ComponentRef Id="Registry.3" />
      <ComponentRef Id="Registry.4" />
      <ComponentRef Id="Registry.5" />
      <ComponentRef Id="Registry.6" />
      <ComponentRef Id="Registry.7" />
      <ComponentRef Id="Registry.8" />
      <ComponentRef Id="Registry.9" />
      <ComponentRef Id="Registry.10" />
      <ComponentRef Id="Registry.11" />
      <ComponentRef Id="Registry.12" />
    </Feature>

    <Feature Id="_...load_into_Civil_3D_on_startup." Title="Autoload into Civil 3D on startup." Absent="allow" Level="1" Description="Check this if you want to register the dll to automatically load upon the launching of AutoCAD Civil 3D.">
      <ComponentRef Id="Registry.13" />
      <ComponentRef Id="Registry.14" />
      <ComponentRef Id="Registry.15" />
      <ComponentRef Id="Registry.16" />
      <ComponentRef Id="Registry.17" />
      <ComponentRef Id="Registry.18" />
      <ComponentRef Id="Registry.19" />
      <ComponentRef Id="Registry.20" />
    </Feature>

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.readme.txt_3785463527" />
      <ComponentRef Id="Component.license.rtf_3413147871" />
      <ComponentRef Id="Component.ATL" />
      <ComponentRef Id="Component.CommandLineArgumentsParser.dll_3014265501" />
      <ComponentRef Id="Component.AutocadTrustedLocations.exe.config_3323726735" />
      <ComponentRef Id="Component.AdUIMgd.dll_1500037100" />
      <ComponentRef Id="Component.CsvHelper.dll_2903748690" />
      <ComponentRef Id="Component.CsvHelper.xml_174603191" />
      <ComponentRef Id="Component.MoreLinq.dll_344342342" />
      <ComponentRef Id="Component.MoreLinq.pdb_1151435664" />
      <ComponentRef Id="Component.MoreLinq.xml_344407850" />
      <ComponentRef Id="Component.Simplifynet.dll_3673655797" />
      <ComponentRef Id="Component.Simplifynet.pdb_1379502573" />
      <ComponentRef Id="Component.System.Buffers.dll_591463195" />
      <ComponentRef Id="Component.System.Buffers.xml_3804686079" />
      <ComponentRef Id="Component.System.Memory.dll_4007401346" />
      <ComponentRef Id="Component.System.Memory.xml_2441055261" />
      <ComponentRef Id="Component.System.Numerics.Vectors.dll_3180875874" />
      <ComponentRef Id="Component.System.Numerics.Vectors.xml_2416201827" />
      <ComponentRef Id="Component.System.Runtime.CompilerServices.Unsafe.dll_2461978377" />
      <ComponentRef Id="Component.System.Runtime.CompilerServices.Unsafe.xml_1762570989" />
      <ComponentRef Id="Component.System.Threading.Tasks.Extensions.dll_498185729" />
      <ComponentRef Id="Component.System.Threading.Tasks.Extensions.xml_2065056102" />
      <ComponentRef Id="Component.System.ValueTuple.dll_3570342207" />
      <ComponentRef Id="Component.System.ValueTuple.xml_2002423258" />
      <ComponentRef Id="Component.TopoHelper.dll_3807985437" />
      <ComponentRef Id="Component.TopoHelper.dll.config_2551281173" />
      <ComponentRef Id="Component.TopoHelper.pdb_4080425795" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="WixSharp_InitRuntime_Action" Before="AppSearch"> (1) </Custom>
      <Custom Action="WixSharp_BeforeInstall_Action" Before="InstallFiles">1</Custom>
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props">1</Custom>
      <Custom Action="Set_ARPINSTALLLOCATION" After="CostFinalize"> (NOT Installed) </Custom>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>

      <RemoveExistingProducts After="InstallInitialize" />
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Action="PreventDowngrading" After="FindRelatedProducts">NEWPRODUCTFOUND</Custom>
    </InstallUISequence>

  </Product>
</Wix>

